!function(t){t.fn.extend({tableExport:function(e){function o(t,e,o){var n="";if(null!==t){var i=g(t,e,o),r=null===i||""===i?"":i.toString();"tsv"==M.type?(i instanceof Date&&i.toLocaleString(),n=u(r,"	"," ")):i instanceof Date?n=M.csvEnclosure+i.toLocaleString()+M.csvEnclosure:(n=u(r,M.csvEnclosure,M.csvEnclosure+M.csvEnclosure),(n.indexOf(M.csvSeparator)>=0||/[\r\n ]/g.test(n))&&(n=M.csvEnclosure+n+M.csvEnclosure))}return n}function n(e){var o=[];return t(e).find("thead").first().find("th").each(function(e,n){void 0!==t(n).attr("data-field")?o[e]=t(n).attr("data-field"):o[e]=e.toString()}),o}function i(e,o){var n=!1;return M.ignoreColumn.length>0&&(-1!=t.inArray(o,M.ignoreColumn)||-1!=t.inArray(o-e,M.ignoreColumn)||H.length>o&&"undefined"!=typeof H[o]&&-1!=t.inArray(H[o],M.ignoreColumn))&&(n=!0),n}function r(e,o,n,r,a){if(-1==t.inArray(n,M.ignoreRow)&&-1==t.inArray(n-r,M.ignoreRow)){var l=t(e).filter(function(){return"none"!=t(this).data("tableexport-display")&&(t(this).is(":visible")||"always"==t(this).data("tableexport-display")||"always"==t(this).closest("table").data("tableexport-display"))}).find(o),s=0;if(l.each(function(e){if(("always"==t(this).data("tableexport-display")||"none"!=t(this).css("display")&&"hidden"!=t(this).css("visibility")&&"none"!=t(this).data("tableexport-display"))&&"function"==typeof a){var o,r,c=1,f=1,d=l.length;if("undefined"!=typeof B[n]&&B[n].length>0){var h=e;for(o=0;h>=o;o++)"undefined"!=typeof B[n][o]&&(a(null,n,o),delete B[n][o],h++);e+=B[n].length,d+=B[n].length}if(t(this).is("[colspan]")&&(c=parseInt(t(this).attr("colspan"))||1,s+=c>0?c-1:0),t(this).is("[rowspan]")&&(f=parseInt(t(this).attr("rowspan"))||1),i(d,e+s)===!1)for(a(this,n,e),o=1;c>o;o++)a(null,n,e+o);if(f>1)for(r=1;f>r;r++)for("undefined"==typeof B[n+r]&&(B[n+r]=[]),B[n+r][e+s]="",o=1;c>o;o++)B[n+r][e+s-o]=""}}),"undefined"!=typeof B[n]&&B[n].length>0)for(var c=0;c<=B[n].length;c++)"undefined"!=typeof B[n][c]&&(a(null,n,c),delete B[n][c])}}function a(t,e){if(M.consoleLog===!0&&console.log(t.output()),"string"===M.outputMode)return t.output();if("base64"===M.outputMode)return T(t.output());if("window"===M.outputMode)return void window.open(URL.createObjectURL(t.output("blob")));try{var o=t.output("blob");saveAs(o,M.fileName+".pdf")}catch(n){E(M.fileName+".pdf","data:application/pdf"+(e?"":";base64")+",",e?t.output("blob"):t.output())}}function l(t,e,o){var n=0;if("undefined"!=typeof o&&(n=o.colspan),n>=0){for(var i=t.width,r=t.textPos.x,a=e.table.columns.indexOf(e.column),l=1;n>l;l++){var s=e.table.columns[a+l];i+=s.width}if(n>1&&("right"===t.styles.halign?r=t.textPos.x+i-t.width:"center"===t.styles.halign&&(r=t.textPos.x+(i-t.width)/2)),t.width=i,t.textPos.x=r,"undefined"!=typeof o&&o.rowspan>1&&(t.height=t.height*o.rowspan),"middle"===t.styles.valign||"bottom"===t.styles.valign){var c="string"==typeof t.text?t.text.split(/\r\n|\r|\n/g):t.text,f=c.length||1;f>2&&(t.textPos.y-=(2-O)/2*e.row.styles.fontSize*(f-2)/3)}return!0}return!1}function s(e,o,n){"undefined"!=typeof n.images&&o.each(function(){var o=t(this).children();if(t(this).is("img")){var i=j(this.src);n.images[i]={url:this.src,src:this.src}}"undefined"!=typeof o&&o.length>0&&s(e,o,n)})}function c(t,e){function o(){e(r)}function n(t){if(t.url){var e=new Image;r=++a,e.crossOrigin="Anonymous",e.onerror=e.onload=function(){if(e.complete&&(0===e.src.indexOf("data:image/")&&(e.width=t.width||e.width||0,e.height=t.height||e.height||0),e.width+e.height)){var n=document.createElement("canvas"),i=n.getContext("2d");n.width=e.width,n.height=e.height,i.drawImage(e,0,0),t.src=n.toDataURL("image/jpeg")}--a||o()},e.src=t.url}}var i,r=0,a=0;if("undefined"!=typeof t.images)for(i in t.images)t.images.hasOwnProperty(i)&&n(t.images[i]);return a||o()}function f(e,o,n){o.each(function(){var o=t(this).children(),i=0;if(t(this).is("div")){var r=b(w(this,"background-color"),[255,255,255]),a=b(w(this,"border-top-color"),[0,0,0]),l=S(this,"border-top-width",M.jspdf.unit),s=this.getBoundingClientRect(),c=this.offsetLeft*n.dw;i=this.offsetTop*n.dh;var d=s.width*n.dw,h=s.height*n.dh;n.doc.setDrawColor.apply(void 0,a),n.doc.setFillColor.apply(void 0,r),n.doc.setLineWidth(l),n.doc.rect(e.x+c,e.y+i,d,h,l?"FD":"F")}else if(t(this).is("img")&&"undefined"!=typeof n.images){var u=j(this.src),p=n.images[u];if("undefined"!=typeof p){var y=e.width/e.height,g=this.width/this.height,m=e.width,v=e.height,x=19.049976/25.4;y>=g?(v=Math.min(e.height,this.height),m=this.width*v/this.height):g>y&&(m=Math.min(e.width,this.width),v=this.height*m/this.width),m*=x,v*=x,v<e.height&&(i=(e.height-v)/2);try{n.doc.addImage(p.src,e.textPos.x,e.y+i,m,v)}catch(C){}e.textPos.x+=m}}"undefined"!=typeof o&&o.length>0&&f(e,o,n)})}function d(e,o,n){if("function"==typeof n.onAutotableText)n.onAutotableText(n.doc,e,o);else{var i=e.textPos.x,r=e.textPos.y,a={halign:e.styles.halign,valign:e.styles.valign};if(o.length){for(var l=o[0];l.previousSibling;)l=l.previousSibling;for(var s=!1,c=!1;l;){var f=l.innerText||l.textContent||"";f=(f.length&&" "==f[0]?" ":"")+t.trim(f)+(f.length>1&&" "==f[f.length-1]?" ":""),t(l).is("br")&&(i=e.textPos.x,r+=n.doc.internal.getFontSize()),t(l).is("b")?s=!0:t(l).is("i")&&(c=!0),(s||c)&&n.doc.setFontType(s&&c?"bolditalic":s?"bold":"italic");var d=n.doc.getStringUnitWidth(f)*n.doc.internal.getFontSize();if(d){if("linebreak"===e.styles.overflow&&i>e.textPos.x&&i+d>e.textPos.x+e.width){var h=".,!%*;:=-";if(h.indexOf(f.charAt(0))>=0){var u=f.charAt(0);d=n.doc.getStringUnitWidth(u)*n.doc.internal.getFontSize(),i+d<=e.textPos.x+e.width&&(n.doc.autoTableText(u,i,r,a),f=f.substring(1,f.length)),d=n.doc.getStringUnitWidth(f)*n.doc.internal.getFontSize()}i=e.textPos.x,r+=n.doc.internal.getFontSize()}for(;f.length&&i+d>e.textPos.x+e.width;)f=f.substring(0,f.length-1),d=n.doc.getStringUnitWidth(f)*n.doc.internal.getFontSize();n.doc.autoTableText(f,i,r,a),i+=d}(s||c)&&(t(l).is("b")?s=!1:t(l).is("i")&&(c=!1),n.doc.setFontType(s||c?s?"bold":"italic":"normal")),l=l.nextSibling}e.textPos.x=i,e.textPos.y=r}else n.doc.autoTableText(e.text,e.textPos.x,e.textPos.y,a)}}function h(t){return t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function u(t,e,o){return t.replace(new RegExp(h(e),"g"),o)}function p(t){return t=t||"0",t=u(t,M.numbers.html.thousandsSeparator,""),t=u(t,M.numbers.html.decimalMark,"."),"number"==typeof t||jQuery.isNumeric(t)!==!1?t:!1}function y(t){return t.indexOf("%")>-1?(t=p(t.replace(/%/g,"")),t!==!1&&(t/=100)):t=!1,t}function g(e,o,n){var i="";if(null!==e){var r,a=t(e);if(a[0].hasAttribute("data-tableexport-value"))r=a.data("tableexport-value"),r=r?r+"":"";else if(r=a.html(),"function"==typeof M.onCellHtmlData)r=M.onCellHtmlData(a,o,n,r);else if(""!=r){var l=t.parseHTML(r),s=0,c=0;r="",t.each(l,function(){t(this).is("input")?r+=a.find("input").eq(s++).val():t(this).is("select")?r+=a.find("select option:selected").eq(c++).text():"undefined"==typeof t(this).html()?r+=t(this).text():(void 0===jQuery().bootstrapTable||t(this).hasClass("filterControl")!==!0)&&(r+=t(this).html())})}if(M.htmlContent===!0)i=t.trim(r);else if(r&&""!=r){var f=r.replace(/\n/g,"\u2028").replace(/<br\s*[\/]?>/gi,"⁠"),d=t("<div/>").html(f).contents(),h=!1;if(f="",t.each(d.text().split("\u2028"),function(e,o){e>0&&(f+=" "),f+=t.trim(o)}),t.each(f.split("⁠"),function(e,o){e>0&&(i+="\n"),i+=t.trim(o).replace(/\u00AD/g,"")}),"json"==M.type||"excel"===M.type&&"xmlss"===M.excelFileFormat||M.numbers.output===!1)h=p(i),h!==!1&&(i=Number(h));else if((M.numbers.html.decimalMark!=M.numbers.output.decimalMark||M.numbers.html.thousandsSeparator!=M.numbers.output.thousandsSeparator)&&(h=p(i),h!==!1)){var u=(""+h.substr(0>h?1:0)).split(".");1==u.length&&(u[1]="");var y=u[0].length>3?u[0].length%3:0;i=(0>h?"-":"")+(M.numbers.output.thousandsSeparator?(y?u[0].substr(0,y)+M.numbers.output.thousandsSeparator:"")+u[0].substr(y).replace(/(\d{3})(?=\d)/g,"$1"+M.numbers.output.thousandsSeparator):u[0])+(u[1].length?M.numbers.output.decimalMark+u[1]:"")}}M.escape===!0&&(i=escape(i)),"function"==typeof M.onCellData&&(i=M.onCellData(a,o,n,i))}return i}function m(t,e,o){return e+"-"+o.toLowerCase()}function b(t,e){var o=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,n=o.exec(t),i=e;return n&&(i=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])]),i}function v(e){var o=w(e,"text-align"),n=w(e,"font-weight"),i=w(e,"font-style"),r="";"start"==o&&(o="rtl"==w(e,"direction")?"right":"left"),n>=700&&(r="bold"),"italic"==i&&(r+=i),""===r&&(r="normal");var a={style:{align:o,bcolor:b(w(e,"background-color"),[255,255,255]),color:b(w(e,"color"),[0,0,0]),fstyle:r},colspan:parseInt(t(e).attr("colspan"))||0,rowspan:parseInt(t(e).attr("rowspan"))||0};if(null!==e){var l=e.getBoundingClientRect();a.rect={width:l.width,height:l.height}}return a}function w(t,e){try{return window.getComputedStyle?(e=e.replace(/([a-z])([A-Z])/,m),window.getComputedStyle(t,null).getPropertyValue(e)):t.currentStyle?t.currentStyle[e]:t.style[e]}catch(o){}return""}function x(t,e,o){var n=100,i=document.createElement("div");i.style.overflow="hidden",i.style.visibility="hidden",t.appendChild(i),i.style.width=n+o;var r=n/i.offsetWidth;return t.removeChild(i),e*r}function S(t,e,o){var n=w(t,e),i=n.match(/\d+/);return null!==i?(i=i[0],x(t.parentElement,i,o)):0}function C(){return this instanceof C?(this.SheetNames=[],void(this.Sheets={})):new C}function N(t){for(var e=new ArrayBuffer(t.length),o=new Uint8Array(e),n=0;n!=t.length;++n)o[n]=255&t.charCodeAt(n);return e}function k(t,e){e&&(t+=1462);var o=Date.parse(t);return(o-new Date(Date.UTC(1899,11,30)))/864e5}function A(t){for(var e={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},n=0;n!=t.length;++n)for(var i=0;i!=t[n].length;++i){o.s.r>n&&(o.s.r=n),o.s.c>i&&(o.s.c=i),o.e.r<n&&(o.e.r=n),o.e.c<i&&(o.e.c=i);var r={v:t[n][i]};if(null!==r.v){var a=XLSX.utils.encode_cell({c:i,r:n});"number"==typeof r.v?r.t="n":"boolean"==typeof r.v?r.t="b":r.v instanceof Date?(r.t="n",r.z=XLSX.SSF._table[14],r.v=k(r.v)):r.t="s",e[a]=r}}return o.s.c<1e7&&(e["!ref"]=XLSX.utils.encode_range(o)),e}function j(t){var e,o,n,i=0;if(0===t.length)return i;for(e=0,n=t.length;n>e;e++)o=t.charCodeAt(e),i=(i<<5)-i+o,i|=0;return i}function E(t,e,o){var n=window.navigator.userAgent;if(t!==!1&&(n.indexOf("MSIE ")>0||n.match(/Trident.*rv\:11\./)))if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(new Blob([o]),t);else{var i=document.createElement("iframe");i&&(document.body.appendChild(i),i.setAttribute("style","display:none"),i.contentDocument.open("txt/html","replace"),i.contentDocument.write(o),i.contentDocument.close(),i.focus(),i.contentDocument.execCommand("SaveAs",!0,t),document.body.removeChild(i))}else{var r=document.createElement("a");if(r){var a=null;r.style.display="none",t!==!1?r.download=t:r.target="_blank","object"==typeof o?(a=window.URL.createObjectURL(o),r.href=a):e.toLowerCase().indexOf("base64,")>=0?r.href=e+T(o):r.href=e+encodeURIComponent(o),document.body.appendChild(r),document.createEvent?(null===W&&(W=document.createEvent("MouseEvents")),W.initEvent("click",!0,!1),r.dispatchEvent(W)):document.createEventObject?r.fireEvent("onclick"):"function"==typeof r.onclick&&r.onclick(),a&&window.URL.revokeObjectURL(a),document.body.removeChild(r)}}}function D(t){t=t.replace(/\x0d\x0a/g,"\n");for(var e="",o=0;o<t.length;o++){var n=t.charCodeAt(o);128>n?e+=String.fromCharCode(n):n>127&&2048>n?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e}function T(t){var e,o,n,i,r,a,l,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",f=0;for(t=D(t);f<t.length;)e=t.charCodeAt(f++),o=t.charCodeAt(f++),n=t.charCodeAt(f++),i=e>>2,r=(3&e)<<4|o>>4,a=(15&o)<<2|n>>6,l=63&n,isNaN(o)?a=l=64:isNaN(n)&&(l=64),c=c+s.charAt(i)+s.charAt(r)+s.charAt(a)+s.charAt(l);return c}var P,M={consoleLog:!1,csvEnclosure:'"',csvSeparator:",",csvUseBOM:!0,displayTableName:!1,escape:!1,excelFileFormat:"xlshtml",excelstyles:[],fileName:"tableExport",htmlContent:!1,ignoreColumn:[],ignoreRow:[],jsonScope:"all",jspdf:{orientation:"p",unit:"pt",format:"a4",margins:{left:20,right:10,top:10,bottom:10},onDocCreated:null,autotable:{styles:{cellPadding:2,rowHeight:12,fontSize:8,fillColor:255,textColor:50,fontStyle:"normal",overflow:"ellipsize",halign:"left",valign:"middle"},headerStyles:{fillColor:[52,73,94],textColor:255,fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:245},tableExport:{doc:null,onAfterAutotable:null,onBeforeAutotable:null,onAutotableText:null,onTable:null,outputImages:!0}}},numbers:{html:{decimalMark:".",thousandsSeparator:","},output:{decimalMark:".",thousandsSeparator:","}},onCellData:null,onCellHtmlData:null,onMsoNumberFormat:null,outputMode:"file",pdfmake:{enabled:!1,docDefinition:{pageOrientation:"portrait",defaultStyle:{font:"Roboto"}},fonts:{}},tbodySelector:"tr",tfootSelector:"tr",theadSelector:"tr",tableName:"myTableName",type:"csv",worksheetName:"Worksheet"},O=1.15,R=this,W=null,F=[],L=[],I=0,B=[],U="",H=[];if(t.extend(!0,M,e),H=n(R),"csv"==M.type||"tsv"==M.type||"txt"==M.type){var z="",K=0;I=0;var X=function(e,n,i){return e.each(function(){U="",r(this,n,I,i+e.length,function(t,e,n){U+=o(t,e,n)+("tsv"==M.type?"	":M.csvSeparator)}),U=t.trim(U).substring(0,U.length-1),U.length>0&&(z.length>0&&(z+="\n"),z+=U),I++}),e.length};if(K+=X(t(R).find("thead").first().find(M.theadSelector),"th,td",K),t(R).find("tbody").each(function(){K+=X(t(this).find(M.tbodySelector),"td,th",K)}),M.tfootSelector.length&&X(t(R).find("tfoot").first().find(M.tfootSelector),"td,th",K),z+="\n",M.consoleLog===!0&&console.log(z),"string"===M.outputMode)return z;if("base64"===M.outputMode)return T(z);if("window"===M.outputMode)return void E(!1,"data:text/"+("csv"==M.type?"csv":"plain")+";charset=utf-8,",z);try{P=new Blob([z],{type:"text/"+("csv"==M.type?"csv":"plain")+";charset=utf-8"}),saveAs(P,M.fileName+"."+M.type,"csv"!=M.type||M.csvUseBOM===!1)}catch(q){E(M.fileName+"."+M.type,"data:text/"+("csv"==M.type?"csv":"plain")+";charset=utf-8,"+("csv"==M.type&&M.csvUseBOM?"\ufeff":""),z)}}else if("sql"==M.type){I=0;var Q="INSERT INTO `"+M.tableName+"` (";if(F=t(R).find("thead").first().find(M.theadSelector),F.each(function(){r(this,"th,td",I,F.length,function(t,e,o){Q+="'"+g(t,e,o)+"',"}),I++,Q=t.trim(Q),Q=t.trim(Q).substring(0,Q.length-1)}),Q+=") VALUES ",t(R).find("tbody").each(function(){L.push.apply(L,t(this).find(M.tbodySelector))}),M.tfootSelector.length&&L.push.apply(L,t(R).find("tfoot").find(M.tfootSelector)),t(L).each(function(){U="",r(this,"td,th",I,F.length+L.length,function(t,e,o){U+="'"+g(t,e,o)+"',"}),U.length>3&&(Q+="("+U,Q=t.trim(Q).substring(0,Q.length-1),Q+="),"),I++}),Q=t.trim(Q).substring(0,Q.length-1),Q+=";",M.consoleLog===!0&&console.log(Q),"string"===M.outputMode)return Q;if("base64"===M.outputMode)return T(Q);try{P=new Blob([Q],{type:"text/plain;charset=utf-8"}),saveAs(P,M.fileName+".sql")}catch(q){E(M.fileName+".sql","data:application/sql;charset=utf-8,",Q)}}else if("json"==M.type){var Y=[];F=t(R).find("thead").first().find(M.theadSelector),F.each(function(){var t=[];r(this,"th,td",I,F.length,function(e,o,n){t.push(g(e,o,n))}),Y.push(t)});var J=[];t(R).find("tbody").each(function(){L.push.apply(L,t(this).find(M.tbodySelector))}),M.tfootSelector.length&&L.push.apply(L,t(R).find("tfoot").find(M.tfootSelector)),t(L).each(function(){var e={},o=0;r(this,"td,th",I,F.length+L.length,function(t,n,i){Y.length?e[Y[Y.length-1][o]]=g(t,n,i):e[o]=g(t,n,i),o++}),t.isEmptyObject(e)===!1&&J.push(e),I++});var V="";if(V="head"==M.jsonScope?JSON.stringify(Y):"data"==M.jsonScope?JSON.stringify(J):JSON.stringify({header:Y,data:J}),M.consoleLog===!0&&console.log(V),"string"===M.outputMode)return V;if("base64"===M.outputMode)return T(V);try{P=new Blob([V],{type:"application/json;charset=utf-8"}),saveAs(P,M.fileName+".json")}catch(q){E(M.fileName+".json","data:application/json;charset=utf-8;base64,",V)}}else if("xml"===M.type){I=0;var $='<?xml version="1.0" encoding="utf-8"?>';$+="<tabledata><fields>",F=t(R).find("thead").first().find(M.theadSelector),F.each(function(){r(this,"th,td",I,F.length,function(t,e,o){$+="<field>"+g(t,e,o)+"</field>"}),I++}),$+="</fields><data>";var _=1;if(t(R).find("tbody").each(function(){L.push.apply(L,t(this).find(M.tbodySelector))}),M.tfootSelector.length&&L.push.apply(L,t(R).find("tfoot").find(M.tfootSelector)),t(L).each(function(){var t=1;U="",r(this,"td,th",I,F.length+L.length,function(e,o,n){U+="<column-"+t+">"+g(e,o,n)+"</column-"+t+">",t++}),U.length>0&&"<column-1></column-1>"!=U&&($+='<row id="'+_+'">'+U+"</row>",_++),I++}),$+="</data></tabledata>",M.consoleLog===!0&&console.log($),"string"===M.outputMode)return $;if("base64"===M.outputMode)return T($);try{P=new Blob([$],{type:"application/xml;charset=utf-8"}),saveAs(P,M.fileName+".xml")}catch(q){E(M.fileName+".xml","data:application/xml;charset=utf-8;base64,",$)}}else if("excel"===M.type&&"xmlss"===M.excelFileFormat){var G=[];t(R).filter(function(){return"none"!=t(this).data("tableexport-display")&&(t(this).is(":visible")||"always"==t(this).data("tableexport-display"))}).each(function(){var e=t(this),o="";I=0,H=n(this),F=e.find("thead").first().find(M.theadSelector),o+="<Table>";var i=0;F.each(function(){U="",r(this,"th,td",I,F.length,function(t,e,o){null!==t&&(U+='<Cell><Data ss:Type="String">'+g(t,e,o)+"</Data></Cell>",i++)}),U.length>0&&(o+="<Row>"+U+"</Row>"),I++}),L=[],e.find("tbody").each(function(){L.push.apply(L,t(this).find(M.tbodySelector))}),t(L).each(function(){U="",r(this,"td,th",I,F.length+L.length,function(t,e,o){if(null!==t){var n="String",i="",r=g(t,e,o);if(jQuery.isNumeric(r)!==!1)n="Number";else{var a=y(r);a!==!1&&(r=a,n="Number",i=' ss:StyleID="pct1"')}"Number"!==n&&(r=r.replace(/\n/g,"<br>")),U+="<Cell"+i+'><Data ss:Type="'+n+'">'+r+"</Data></Cell>"}}),U.length>0&&(o+="<Row>"+U+"</Row>"),I++}),o+="</Table>",G.push(o),M.consoleLog===!0&&console.log(o)});for(var Z=(new Date).toISOString(),tt='<?xml version="1.0" encoding="UTF-8"?><?mso-application progid="Excel.Sheet"?> <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40"> <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"> <Created>'+Z+'</Created> </DocumentProperties> <OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office"> <AllowPNG/> </OfficeDocumentSettings> <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"> <WindowHeight>9000</WindowHeight> <WindowWidth>13860</WindowWidth> <WindowTopX>0</WindowTopX> <WindowTopY>0</WindowTopY> <ProtectStructure>False</ProtectStructure> <ProtectWindows>False</ProtectWindows> </ExcelWorkbook> <Styles> <Style ss:ID="Default" ss:Name="Default"> <Alignment ss:Vertical="Center"/> <Borders/> <Font/> <Interior/> <NumberFormat/> <Protection/> </Style> <Style ss:ID="Normal" ss:Name="Normal"/> <Style ss:ID="pct1">   <NumberFormat ss:Format="Percent"/> </Style> </Styles>',et=0;et<G.length;et++){var ot="string"==typeof M.worksheetName?M.worksheetName+" "+(et+1):"undefined"!=typeof M.worksheetName[et]?M.worksheetName[et]:"Table "+(et+1);tt+='<Worksheet ss:Name="'+ot+'">'+G[et]+"<WorksheetOptions/> </Worksheet>"}if(tt+="</Workbook>",M.consoleLog===!0&&console.log(tt),"string"===M.outputMode)return tt;if("base64"===M.outputMode)return T(tt);try{P=new Blob([tt],{type:"application/xml;charset=utf-8"}),saveAs(P,M.fileName+".xml")}catch(q){E(M.fileName+".xml","data:application/xml;charset=utf-8;base64,",tt)}}else if("excel"==M.type||"xls"==M.type||"word"==M.type||"doc"==M.type){var nt="excel"==M.type||"xls"==M.type?"excel":"word",it="excel"==nt?"xls":"doc",rt='xmlns:x="urn:schemas-microsoft-com:office:'+nt+'"',at="";t(R).filter(function(){return"none"!=t(this).data("tableexport-display")&&(t(this).is(":visible")||"always"==t(this).data("tableexport-display"))}).each(function(){var e=t(this);I=0,H=n(this),at+="<table><thead>",F=e.find("thead").first().find(M.theadSelector),F.each(function(){U="",r(this,"th,td",I,F.length,function(e,o,n){if(null!==e){var i="";U+="<th";for(var r in M.excelstyles)if(M.excelstyles.hasOwnProperty(r)){var a=t(e).css(M.excelstyles[r]);""!==a&&"0px none rgb(0, 0, 0)"!=a&&"rgba(0, 0, 0, 0)"!=a&&(i+=""===i?'style="':";",i+=M.excelstyles[r]+":"+a)}""!==i&&(U+=" "+i+'"'),t(e).is("[colspan]")&&(U+=' colspan="'+t(e).attr("colspan")+'"'),t(e).is("[rowspan]")&&(U+=' rowspan="'+t(e).attr("rowspan")+'"'),U+=">"+g(e,o,n)+"</th>"}}),U.length>0&&(at+="<tr>"+U+"</tr>"),I++}),at+="</thead><tbody>",e.find("tbody").each(function(){L.push.apply(L,t(this).find(M.tbodySelector))}),M.tfootSelector.length&&L.push.apply(L,e.find("tfoot").find(M.tfootSelector)),t(L).each(function(){var e=t(this);U="",r(this,"td,th",I,F.length+L.length,function(o,n,i){if(null!==o){var r=g(o,n,i),a="",l=t(o).data("tableexport-msonumberformat");"undefined"==typeof l&&"function"==typeof M.onMsoNumberFormat&&(l=M.onMsoNumberFormat(o,n,i)),"undefined"!=typeof l&&""!==l&&(a="style=\"mso-number-format:'"+l+"'");for(var s in M.excelstyles)M.excelstyles.hasOwnProperty(s)&&(l=t(o).css(M.excelstyles[s]),""===l&&(l=e.css(M.excelstyles[s])),""!==l&&"0px none rgb(0, 0, 0)"!=l&&"rgba(0, 0, 0, 0)"!=l&&(a+=""===a?'style="':";",a+=M.excelstyles[s]+":"+l));U+="<td",""!==a&&(U+=" "+a+'"'),t(o).is("[colspan]")&&(U+=' colspan="'+t(o).attr("colspan")+'"'),t(o).is("[rowspan]")&&(U+=' rowspan="'+t(o).attr("rowspan")+'"'),"string"==typeof r&&""!=r&&(r=r.replace(/\n/g,"<br>")),U+=">"+r+"</td>"}}),U.length>0&&(at+="<tr>"+U+"</tr>"),I++}),M.displayTableName&&(at+="<tr><td></td></tr><tr><td></td></tr><tr><td>"+g(t("<p>"+M.tableName+"</p>"))+"</td></tr>"),at+="</tbody></table>",M.consoleLog===!0&&console.log(at)});var lt='<html xmlns:o="urn:schemas-microsoft-com:office:office" '+rt+' xmlns="http://www.w3.org/TR/REC-html40">';if(lt+='<meta http-equiv="content-type" content="application/vnd.ms-'+nt+'; charset=UTF-8">',lt+="<head>","excel"===nt&&(lt+="<!--[if gte mso 9]>",lt+="<xml>",lt+="<x:ExcelWorkbook>",lt+="<x:ExcelWorksheets>",lt+="<x:ExcelWorksheet>",lt+="<x:Name>",lt+=M.worksheetName,lt+="</x:Name>",lt+="<x:WorksheetOptions>",lt+="<x:DisplayGridlines/>",lt+="</x:WorksheetOptions>",lt+="</x:ExcelWorksheet>",lt+="</x:ExcelWorksheets>",lt+="</x:ExcelWorkbook>",lt+="</xml>",lt+="<![endif]-->"),lt+="<style>br {mso-data-placement:same-cell;}</style>",lt+="</head>",lt+="<body>",lt+=at,lt+="</body>",lt+="</html>",M.consoleLog===!0&&console.log(lt),"string"===M.outputMode)return lt;if("base64"===M.outputMode)return T(lt);try{P=new Blob([lt],{type:"application/vnd.ms-"+M.type}),saveAs(P,M.fileName+"."+it)}catch(q){E(M.fileName+"."+it,"data:application/vnd.ms-"+nt+";base64,",lt)}}else if("xlsx"==M.type){var st=[],ct=[];I=0,L=t(R).find("thead").first().find(M.theadSelector),t(R).find("tbody").each(function(){L.push.apply(L,t(this).find(M.tbodySelector))}),M.tfootSelector.length&&L.push.apply(L,t(R).find("tfoot").find(M.tfootSelector)),t(L).each(function(){var t=[];r(this,"th,td",I,L.length,function(e,o,n){if("undefined"!=typeof e&&null!==e){var i=g(e,o,n),r=parseInt(e.getAttribute("colspan")),a=parseInt(e.getAttribute("rowspan"));if(ct.forEach(function(e){if(I>=e.s.r&&I<=e.e.r&&t.length>=e.s.c&&t.length<=e.e.c)for(var o=0;o<=e.e.c-e.s.c;++o)t.push(null)}),(a||r)&&(a=a||1,r=r||1,ct.push({s:{r:I,c:t.length},e:{r:I+a-1,c:t.length+r-1}})),"function"!=typeof M.onCellData&&""!==i&&i==+i&&(i=+i),t.push(""!==i?i:null),r)for(var l=0;r-1>l;++l)t.push(null)}}),st.push(t),I++});var ft=new C,dt=A(st);dt["!merges"]=ct,ft.SheetNames.push(M.worksheetName),ft.Sheets[M.worksheetName]=dt;var ht=XLSX.write(ft,{bookType:M.type,bookSST:!1,type:"binary"});try{P=new Blob([N(ht)],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),saveAs(P,M.fileName+"."+M.type)}catch(q){E(M.fileName+"."+M.type,"data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8,",N(ht))}}else if("png"==M.type)html2canvas(t(R)[0]).then(function(t){for(var e=t.toDataURL(),o=atob(e.substring(22)),n=new ArrayBuffer(o.length),i=new Uint8Array(n),r=0;r<o.length;r++)i[r]=o.charCodeAt(r);if(M.consoleLog===!0&&console.log(o),"string"===M.outputMode)return o;if("base64"===M.outputMode)return T(e);if("window"===M.outputMode)return void window.open(e);try{P=new Blob([n],{type:"image/png"}),saveAs(P,M.fileName+".png")}catch(a){E(M.fileName+".png","data:image/png,",P)}});else if("pdf"==M.type)if(M.pdfmake.enabled===!0){var ut=[],pt=[];I=0;var yt=function(e,o,n){var i=0;return t(e).each(function(){var t=[];r(this,o,I,n,function(e,o,n){if("undefined"!=typeof e&&null!==e){var i=parseInt(e.getAttribute("colspan")),r=parseInt(e.getAttribute("rowspan")),a=g(e,o,n)||" ";i>1||r>1?(i=i||1,r=r||1,t.push({colSpan:i,rowSpan:r,text:a})):t.push(a)}else t.push(" ")}),t.length&&pt.push(t),i<t.length&&(i=t.length),I++}),i};F=t(this).find("thead").first().find(M.theadSelector);for(var gt=yt(F,"th,td",F.length),mt=ut.length;gt>mt;mt++)ut.push("*");t(this).find("tbody").each(function(){L.push.apply(L,t(this).find(M.tbodySelector))}),M.tfootSelector.length&&L.push.apply(L,t(this).find("tfoot").find(M.tfootSelector)),yt(L,"th,td",F.length+L.length);var bt={content:[{table:{headerRows:F.length,widths:ut,body:pt}}]};t.extend(!0,bt,M.pdfmake.docDefinition),pdfMake.fonts={Roboto:{normal:"Roboto-Regular.ttf",bold:"Roboto-Medium.ttf",italics:"Roboto-Italic.ttf",bolditalics:"Roboto-MediumItalic.ttf"}},t.extend(!0,pdfMake.fonts,M.pdfmake.fonts),pdfMake.createPdf(bt).getBuffer(function(t){try{var e=new Blob([t],{type:"application/pdf"});saveAs(e,M.fileName+".pdf")}catch(o){E(M.fileName+".pdf","data:application/pdf;base64,",t)}})}else if(M.jspdf.autotable===!1){var vt={dim:{w:S(t(R).first().get(0),"width","mm"),h:S(t(R).first().get(0),"height","mm")},pagesplit:!1},wt=new jsPDF(M.jspdf.orientation,M.jspdf.unit,M.jspdf.format);wt.addHTML(t(R).first(),M.jspdf.margins.left,M.jspdf.margins.top,vt,function(){a(wt,!1)})}else{var xt=M.jspdf.autotable.tableExport;if("string"==typeof M.jspdf.format&&"bestfit"===M.jspdf.format.toLowerCase()){var St={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89]},Ct="",Nt="",kt=0;t(R).filter(":visible").each(function(){if("none"!=t(this).css("display")){var e=S(t(this).get(0),"width","pt");if(e>kt){e>St.a0[0]&&(Ct="a0",Nt="l");for(var o in St)St.hasOwnProperty(o)&&St[o][1]>e&&(Ct=o,Nt="l",St[o][0]>e&&(Nt="p"));kt=e}}}),M.jspdf.format=""===Ct?"a4":Ct,M.jspdf.orientation=""===Nt?"w":Nt}null==xt.doc&&(xt.doc=new jsPDF(M.jspdf.orientation,M.jspdf.unit,M.jspdf.format),"function"==typeof M.jspdf.onDocCreated&&M.jspdf.onDocCreated(xt.doc)),xt.outputImages===!0&&(xt.images={}),"undefined"!=typeof xt.images&&(t(R).filter(function(){return"none"!=t(this).data("tableexport-display")&&(t(this).is(":visible")||"always"==t(this).data("tableexport-display"))}).each(function(){var e=0;F=t(this).find("thead").find(M.theadSelector),t(this).find("tbody").each(function(){L.push.apply(L,t(this).find(M.tbodySelector))}),M.tfootSelector.length&&L.push.apply(L,t(this).find("tfoot").find(M.tfootSelector)),t(L).each(function(){r(this,"td,th",F.length+e,F.length+L.length,function(e){if("undefined"!=typeof e&&null!==e){var o=t(e).children();"undefined"!=typeof o&&o.length>0&&s(e,o,xt)}}),e++})}),F=[],L=[]),c(xt,function(){t(R).filter(function(){return"none"!=t(this).data("tableexport-display")&&(t(this).is(":visible")||"always"==t(this).data("tableexport-display"))}).each(function(){var e,o=0;if(H=n(this),xt.columns=[],xt.rows=[],xt.rowoptions={},"function"==typeof xt.onTable&&xt.onTable(t(this),M)===!1)return!0;M.jspdf.autotable.tableExport=null;var i=t.extend(!0,{},M.jspdf.autotable);if(M.jspdf.autotable.tableExport=xt,i.margin={},t.extend(!0,i.margin,M.jspdf.margins),i.tableExport=xt,"function"!=typeof i.beforePageContent&&(i.beforePageContent=function(t){if(1==t.pageCount){var e=t.table.rows.concat(t.table.headerRow);e.forEach(function(e){e.height>0&&(e.height+=(2-O)/2*e.styles.fontSize,t.table.height+=(2-O)/2*e.styles.fontSize)})}}),"function"!=typeof i.createdHeaderCell&&(i.createdHeaderCell=function(e,o){if(e.styles=t.extend({},o.row.styles),"undefined"!=typeof xt.columns[o.column.dataKey]){var n=xt.columns[o.column.dataKey];if("undefined"!=typeof n.rect){var r;e.contentWidth=n.rect.width,("undefined"==typeof xt.heightRatio||0===xt.heightRatio)&&(r=o.row.raw[o.column.dataKey].rowspan?o.row.raw[o.column.dataKey].rect.height/o.row.raw[o.column.dataKey].rowspan:o.row.raw[o.column.dataKey].rect.height,xt.heightRatio=e.styles.rowHeight/r),r=o.row.raw[o.column.dataKey].rect.height*xt.heightRatio,r>e.styles.rowHeight&&(e.styles.rowHeight=r)}"undefined"!=typeof n.style&&n.style.hidden!==!0&&(e.styles.halign=n.style.align,"inherit"===i.styles.fillColor&&(e.styles.fillColor=n.style.bcolor),"inherit"===i.styles.textColor&&(e.styles.textColor=n.style.color),"inherit"===i.styles.fontStyle&&(e.styles.fontStyle=n.style.fstyle))}}),"function"!=typeof i.createdCell&&(i.createdCell=function(t,e){var o=xt.rowoptions[e.row.index+":"+e.column.dataKey];"undefined"!=typeof o&&"undefined"!=typeof o.style&&o.style.hidden!==!0&&(t.styles.halign=o.style.align,"inherit"===i.styles.fillColor&&(t.styles.fillColor=o.style.bcolor),"inherit"===i.styles.textColor&&(t.styles.textColor=o.style.color),"inherit"===i.styles.fontStyle&&(t.styles.fontStyle=o.style.fstyle))}),"function"!=typeof i.drawHeaderCell&&(i.drawHeaderCell=function(t,e){var o=xt.columns[e.column.dataKey];return(o.style.hasOwnProperty("hidden")!==!0||o.style.hidden!==!0)&&o.rowIndex>=0?l(t,e,o):!1}),"function"!=typeof i.drawCell&&(i.drawCell=function(t,e){var o=xt.rowoptions[e.row.index+":"+e.column.dataKey];if(l(t,e,o))if(xt.doc.rect(t.x,t.y,t.width,t.height,t.styles.fillStyle),"undefined"!=typeof o&&"undefined"!=typeof o.kids&&o.kids.length>0){var n=t.height/o.rect.height;(n>xt.dh||"undefined"==typeof xt.dh)&&(xt.dh=n),xt.dw=t.width/o.rect.width;var i=t.textPos.y;f(t,o.kids,xt),t.textPos.y=i,d(t,o.kids,xt)}else d(t,{},xt);return!1}),xt.headerrows=[],F=t(this).find("thead").find(M.theadSelector),F.each(function(){e=0,xt.headerrows[o]=[],r(this,"th,td",o,F.length,function(t,n,i){var r=v(t);r.title=g(t,n,i),r.key=e++,r.rowIndex=o,xt.headerrows[o].push(r)}),o++}),o>0)for(var a=o-1;a>=0;)t.each(xt.headerrows[a],function(){var t=this;a>0&&null===this.rect&&(t=xt.headerrows[a-1][this.key]),null!==t&&t.rowIndex>=0&&(t.style.hasOwnProperty("hidden")!==!0||t.style.hidden!==!0)&&xt.columns.push(t)}),a=xt.columns.length>0?-1:a-1;var s=0;L=[],t(this).find("tbody").each(function(){L.push.apply(L,t(this).find(M.tbodySelector))}),M.tfootSelector.length&&L.push.apply(L,t(this).find("tfoot").find(M.tfootSelector)),t(L).each(function(){var n=[];e=0,r(this,"td,th",o,F.length+L.length,function(o,i,r){var a;"undefined"==typeof xt.columns[e]&&(a={title:"",key:e,style:{hidden:!0}},xt.columns.push(a)),"undefined"!=typeof o&&null!==o?(a=v(o),a.kids=t(o).children(),xt.rowoptions[s+":"+e++]=a):(a=t.extend(!0,{},xt.rowoptions[s+":"+(e-1)]),a.colspan=-1,xt.rowoptions[s+":"+e++]=a),n.push(g(o,i,r))}),n.length&&(xt.rows.push(n),s++),o++}),"function"==typeof xt.onBeforeAutotable&&xt.onBeforeAutotable(t(this),xt.columns,xt.rows,i),xt.doc.autoTable(xt.columns,xt.rows,i),"function"==typeof xt.onAfterAutotable&&xt.onAfterAutotable(t(this),i),M.jspdf.autotable.startY=xt.doc.autoTableEndPosY()+i.margin.top}),a(xt.doc,"undefined"!=typeof xt.images&&jQuery.isEmptyObject(xt.images)===!1),"undefined"!=typeof xt.headerrows&&(xt.headerrows.length=0),"undefined"!=typeof xt.columns&&(xt.columns.length=0),"undefined"!=typeof xt.rows&&(xt.rows.length=0),delete xt.doc,xt.doc=null})}return this}})}(jQuery);